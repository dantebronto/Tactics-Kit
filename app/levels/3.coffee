window.p1 = new Player 
  x: 13, y: 21, name: 'd00d'
  # isBot: true
  level: 10

window.p2 = new Player 
  x: 27, y: 4, name: 'lady'
  strength: 20
  sprite: '/images/girl.gif'
  # isBot: true
  level: 10
  weapon: new Weapon 
    range: 3

p3 = new Engineer
  x: 10, y: 10
  name: 'Ace'
  level: 5
  sprite: '/images/penguin.gif'

window.e1 = new Enemy
  sprite: '/images/penguin2.gif'
  name: 'Robo Duck'
  x: 34, y: 34
  level: 5

window.e2 = new Enemy
  sprite: '/images/penguin2.gif'
  name: 'Robo Duck'
  x: 11, y: 29
  level: 5

window.e3 = new Enemy
  sprite: '/images/penguin2.gif'
  name: 'Robo Duck'
  x: 12, y: 30
  level: 5
  
window.e4 = new Enemy
  sprite: '/images/penguin2.gif'
  name: 'Robo Duck'
  x: 39, y: 16
  level: 5
  
window.e5 = new Enemy
  sprite: '/images/penguin2.gif'
  name: 'Robo Duck'
  x: 21, y: 35
  level: 5
  
# level 1
terrain = [ 
  #  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39
  [ 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10 ] # 0
  [ 10, 10, 10, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 10 ] # 1
  [ 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 15, 15, 15, 15, 10 ] # 2
  [ 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 15, 15, 15, 10, 10 ] # 3
  [ 10, 10, 15, 15, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 10, 10 ] # 4
  [ 10, 10, 15, 15, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10 ] # 5
  [ 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10 ] # 6
  [ 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10 ] # 7
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10 ] # 8
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 10, 10, 10 ] # 9
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 10, 10, 10, 10, 15, 10, 10, 10 ] #10
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 10, 10, 10, 10, 15, 10, 10, 10 ] #11
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10 ] #12
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10, 15, 10, 10, 10 ] #13
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 10, 15, 15, 15, 15, 15, 10, 10, 10 ] #14
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10 ] #15
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 10, 10, 10, 10, 10 ] #16
  [ 10, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10 ] #17
  [ 10, 10, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10 ] #18
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10 ] #19
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 10, 10, 10, 10, 10 ] #20
  [ 10, 10, 15, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10 ] #21
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10 ] #22
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10 ] #23
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10 ] #24
  [ 10, 10, 10, 15, 15, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 10, 10, 10, 10, 10 ] #25
  [ 10, 10, 15, 15, 15, 10, 15, 10, 10, 15, 10, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 10, 10, 10, 10, 10 ] #26
  [ 10, 10, 15, 15, 10, 15, 10, 10, 10, 15, 15, 10, 10, 10, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 15, 15, 15, 15, 10, 10, 10, 10, 10 ] #27
  [ 10, 10, 15, 15, 10, 15, 10, 10, 10, 15, 15, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 15, 15, 15, 10, 10, 10, 10, 10 ] #28
  [ 10, 15, 15, 15, 10, 10, 10, 10, 10, 15, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 15, 15, 15, 10, 10, 10, 10, 10 ] #29
  [ 10, 15, 15, 15, 10, 10, 10, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 10, 10, 10, 10, 10 ] #30
  [ 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10 ] #31
  [ 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10 ] #32
  [ 15, 15, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10 ] #33
  [ 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10 ] #34
  [ 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10 ] #35
  [ 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10 ] #36
  [ 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10 ] #37
]

window.level = new Level
  map:
    terrain: terrain
    width: 2000
    height: 1900
    backgroundImage: '/images/moathouse.jpg'
    selector: '#map'
  players: [p1, p2, p3]
  enemies: [e1, e2, e3, e4, e5]
  animationInterval: 100

level.queue =>
  p1.addDefaultSpecials()
  p2.addDefaultSpecials()
  p3.addDefaultSpecials()
  Special.bindBomb(p2)

level.queue(5).queue => 
  level.map.terrainMatrix.each (x, y) ->
    num = Number(this)
    level.map.mapMatrix.get(x, y).css('background', 'url(/images/grass.jpg) no-repeat center')
    if num == 15
      level.map.itemMatrix.get(x, y).css('background', 'url(/images/shrub.png) no-repeat center')
  
  level.start()